<!DOCTYPE html>
<html lang="en">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.classless.min.css">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta charset="UTF-8">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/styles/base16/material-palenight.min.css"><script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/highlight.min.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin="anonymous" referrerpolicy="no-referrer">
      <link rel="alternate" type="application/atom+xml" title="A blog by Jason Mobarak" href="../atom.xml">
      <title>CyanogenMod (AOSP) and Vim Build Integration</title><style>
      .hljs {
        font-family: "Menlo","Consolas","Roboto Mono","Ubuntu Monospace","Noto Mono","Oxygen Mono","Liberation Mono",monospace,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";
        font-size: 16px;
      }
      :root {
        --typography-spacing-vertical: 0.75rem;
      }
      h1, h2, h3, h4 {
        --typography-spacing-vertical: 1rem;
      }
      article {
        margin-top: 1rem !important;
        padding-top: 1rem !important;
        margin-bottom: 1rem !important;
        padding-bottom: 1rem !important;
      }
      pre code {
        padding: 1em !important;
      }
      code {
        padding: 0.1rem 0.2rem !important;
      }
      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.25rem 0 !important;
        border-bottom: 1px solid var(--muted-border-color);
        margin-bottom: 0;
        --block-spacing-vertical: 0.25rem;
      }
      header .logo {
        font-weight: bold;
        font-size: 1.2rem;
        text-decoration: none;
        color: var(--primary);
      }
      header nav {
        display: flex;
        gap: 1rem;
      }
      header nav a {
        text-decoration: none;
        color: var(--color);
        padding: 0.5rem;
        border-radius: var(--border-radius);
        transition: background-color 0.2s;
      }
      header nav a:hover {
        background-color: var(--secondary-focus);
      }
      body {
        margin: 0;
        padding: 0.5rem;
      }
      main {
        margin-top: 0.5rem;
      }
      footer {
        margin-top: 2rem;
        padding: 1rem 0;
        border-top: 1px solid var(--muted-border-color);
        text-align: center;
        font-size: 0.875rem;
        color: var(--muted-color);
      }
      footer .social-links {
        margin: 1rem 0;
      }
      footer .social-links a {
        margin: 0 0.5rem;
        color: var(--muted-color);
        text-decoration: none;
        font-size: 1.25rem;
        transition: color 0.2s;
      }
      footer .social-links a:hover {
        color: var(--primary);
      }
      footer .copyright {
        margin: 0.5rem 0;
      }
      footer .license {
        margin: 0.5rem 0;
        font-size: 0.8rem;
      }

      /* Sidebar layout for posts */
      .post-layout {
        display: grid;
        grid-template-columns: 1fr 250px;
        gap: 2rem;
        max-width: 1200px;
        margin: 0 auto;
      }

      .post-content {
        min-width: 0; /* Prevents grid overflow */
      }

      .post-sidebar {
        position: sticky;
        top: 1rem;
        height: fit-content;
        max-height: calc(100vh - 2rem);
        overflow-y: auto;
      }

      .toc {
        background-color: var(--card-background-color);
        border: 1px solid var(--card-border-color);
        border-radius: var(--border-radius);
        padding: 1rem;
      }

      .toc h3 {
        margin: 0 0 0.75rem 0;
        font-size: 1rem;
        color: var(--color);
      }

      .toc ul {
        list-style: none;
        margin: 0;
        padding: 0;
      }

      .toc li {
        margin: 0.25rem 0;
      }

      .toc a {
        text-decoration: none;
        color: var(--muted-color);
        font-size: 0.875rem;
        display: block;
        padding: 0.25rem 0;
        transition: color 0.2s;
      }

      .toc a:hover {
        color: var(--primary);
      }

      .toc .toc-h2 {
        font-weight: 500;
      }

      .toc .toc-h3 {
        padding-left: 1rem;
        font-size: 0.8rem;
      }

      .toc .toc-h4 {
        padding-left: 2rem;
        font-size: 0.75rem;
      }

      /* Responsive behavior */
      @media (max-width: 768px) {
        .post-layout {
          grid-template-columns: 1fr;
          gap: 1rem;
        }

        .post-sidebar {
          position: static;
          order: -1;
          max-height: none;
        }

        .toc {
          margin-bottom: 1rem;
        }
      }

      /* Smooth scrolling */
      html {
        scroll-behavior: smooth;
      }

      /* Heading anchor styling */
      h2[id], h3[id], h4[id] {
        scroll-margin-top: 1rem;
      }
    </style></head>
   <body>
      <header><a href="../" class="logo">Jason Mobarak - Weblog</a><nav><a href="../about.html"><i class="fas fa-user"></i> About</a><a href="../tags.html"><i class="fas fa-tags"></i> Tags</a><a href="../atom.xml"><i class="fas fa-rss"></i> Feed</a><a href="https://github.com/silverjam/silverjam.github.io"><i class="fab fa-github"></i> GitHub</a></nav>
      </header>
      <main>
         <h1>CyanogenMod (AOSP) and Vim Build Integration</h1>
         <table>
            <thead>
               <tr>
                  <td>Metadata</td>
                  <td>Value</td>
               </tr>
            </thead>
            <tbody>
               <tr>
                  <td>Date</td>
                  <td>2014-03-06</td>
               </tr>
               <tr>
                  <td>Categories</td>
                  <td><a href="../tags.html#android">android</a>, <a href="../tags.html#archive">archive</a></td>
               </tr>
            </tbody>
         </table>
         <div class="post-layout">
            <div class="post-content">
               <article>
                  <p>The build system AOSP and CyanogenMod have some interesting shell scripts that 
                     make it easier to build various parts of the system:
                  </p>
                  <ul>
                     <li>
                        <p><code>breakfast [device]</code> -- selects a particular device for building
                        </p>
                     </li>
                     <li>
                        <p><code>brunch [device]</code> -- building the entire image for the device
                        </p>
                     </li>
                     <li>
                        <p><code>mka bacon</code> -- almost the same as <code>brunch</code>, but, mmm.... bacon....
                        </p>
                     </li>
                     <li>
                        <p><code>mm [make_args]</code> -- builds whatever module you happen to be in, just that 
                           module
                        </p>
                     </li>
                     <li>
                        <p><code>mmp [make_args]</code> -- builds whatever module you happen to be in, just that 
                           module, and pushes it to the device
                        </p>
                     </li>
                  </ul>
                  <p>So... the mm and mmp directives seem like great shortcuts to shorten your 
                     develop / compile / test cycle, right?  But what about editor completion?  You 
                     can't invoke mm and mmp in a vim session in order to munch on the compile 
                     errors?!  Fret not!  Now you can!
                  </p>
                  <p>The first step is a couple of nifty shell scripts.  They probably represent a 
                     horrible compromise of your security, so use with care.  But here they are...
                  </p>
                  <p>The first is a server of sorts, it sits in a open shell session, one that's all 
                     setup to build Android:
                  </p><pre><code class="language-bash do_over_there_listen.sh">#!/bin/bash

FIFO_STDINP="/tmp/do_over_there.stdinp.fifo"
FIFO_STDOUT="/tmp/do_over_there.stdout.fifo"
FIFO_STDERR="/tmp/do_over_there.stderr.fifo"

do_stuff_here() {
    rm -vf $FIFO_STDINP
    rm -vf $FIFO_STDOUT
    rm -vf $FIFO_STDERR

    mkfifo $FIFO_STDINP
    mkfifo $FIFO_STDOUT
    mkfifo $FIFO_STDERR

    while read line &lt;$FIFO_STDINP ; do
        echo "Running: $line"
        eval $line &gt;$FIFO_STDOUT 2&gt;$FIFO_STDERR
    done
}
</code></pre><p>You run this script like so:</p><pre><code class="language-text run do_stuff_here">$ . ~/Scripts/do_over_there_listen.sh ; do_stuff_here
removed `/tmp/do_over_there.stdinp.fifo'
removed `/tmp/do_over_there.stdout.fifo'
removed `/tmp/do_over_there.stderr.fifo'
</code></pre><p>The next step is a script that takes the place of make in your vim session:</p><pre><code class="language-bash do_over_there">#!/bin/bash

D=$(dirname $(readlink -f ${BASH_SOURCE}))
source "$D/do_over_there_listen.sh"

echo "mm $@" &gt;$FIFO_STDINP

cat $FIFO_STDOUT &amp;
cat $FIFO_STDERR &gt;&amp;2 &amp;

wait
</code></pre><p>Then, the final piece of the puzzle is to tell vim to use the new "make" 
                     command with (after <code>chmod +x do_over_there</code> of course):
                  </p><pre><code class="language-text vimrc mods">set makeprg=~/path/to/do_over_there
</code></pre><p>Finally, you'll be able to compile with the AOSP and CyanogenMod build system 
                     niceties but then suck those error logs into vim.  Like so:
                  </p><img src=../images/do-over-there.gif />
                  
               </article>
            </div>
            <div class="post-sidebar"></div>
         </div>
      </main>
      <footer>
         <div class="social-links"><a href="https://github.com/silverjam" title="GitHub" aria-label="GitHub"><i class="fab fa-github"></i></a><a href="https://hachyderm.io/@silverjam" title="Mastodon" aria-label="Mastodon"><i class="fab fa-mastodon"></i></a><a href="https://www.threads.com/@silv3rjam" title="Threads" aria-label="Threads"><i class="fa-brands fa-threads"></i></a><a href="https://www.instagram.com/silv3rjam/" title="Instagram" aria-label="Instagram"><i class="fab fa-instagram"></i></a><a href="https://www.linkedin.com/in/silverjam" title="LinkedIn" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a></div>
         <div class="copyright">
            © 2025 Jason Mobarak
            
         </div>
         <div class="license"><a href="https://creativecommons.org/licenses/by-sa/4.0/" rel="license"><i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i><i class="fab fa-creative-commons-sa"></i></a>
            This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License
            · <a href="../sitemap.xml">Sitemap</a></div>
      </footer><script>hljs.highlightAll();</script></body>
</html>